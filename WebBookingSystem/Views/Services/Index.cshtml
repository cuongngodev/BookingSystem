@model PaginatedList<BookingSystem.Data.Entities.Service>
@{
    ViewData["Title"] = "Manage Services";
    Layout = "_Layout";
}

<div class="container py-5">

    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
        <h2 class="fw-bold text-white mb-3">🧰 Manage Services</h2>
        <a asp-action="Create" class="btn btn-light rounded-pill px-4 shadow-sm">
            <i class="bi bi-plus-circle"></i> Create New
        </a>
    </div>

    <!-- Search -->
    <form asp-action="Index" method="get" class="mb-4">
        <div class="input-group">
            <input type="text" name="SearchString" value="@ViewData["CurrentFilter"]"
                   class="form-control" placeholder="Search service by name..." />
            <button type="submit" class="btn btn-outline-light">
                <i class="bi bi-search"></i>
            </button>
            <a asp-action="Index" class="btn btn-outline-secondary">Reset</a>
        </div>
    </form>

    <!-- Glass-styled card for table -->
    <div class="card glass-card shadow-sm">
        <div class="card-body p-4">
            <table class="table table-hover align-middle text-light">
                <thead class="table-header text-uppercase small text-secondary">
                    <tr>
                        <th>
                            <a asp-action="Index"
                               asp-route-sortOrder="@ViewData["NameSortParm"]"
                               asp-route-currentFilter="@ViewData["CurrentFilter"]"
                               class="text-decoration-none text-light">
                                Name
                                <i class="bi bi-sort-alpha-down"></i>
                            </a>
                        </th>
                        <th>
                            <a asp-action="Index"
                               asp-route-sortOrder="@ViewData["DurationSortParm"]"
                               asp-route-currentFilter="@ViewData["CurrentFilter"]"
                               class="text-decoration-none text-light">
                                Duration (min)
                                <i class="bi bi-clock-history"></i>
                            </a>
                        </th>
                        <th>
                            <a asp-action="Index"
                               asp-route-sortOrder="@ViewData["PriceSortParm"]"
                               asp-route-currentFilter="@ViewData["CurrentFilter"]"
                               class="text-decoration-none text-light">
                                Price ($)
                                <i class="bi bi-currency-dollar"></i>
                            </a>
                        </th>
                        <th>Description</th>
                        <th class="text-end">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        foreach (var item in Model)
                        {
                            <tr>
                                <td>@item.Name</td>
                                <td>@item.Duration min</td>
                                <td>$@item.Price</td>
                                <td>@item.Description</td>
                                <td class="text-end">
                                    <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-outline-light me-1">
                                        <i class="bi bi-eye"></i>
                                    </a>
                                    @if (User.IsInRole("Admin"))
                                    {
                                        
                                        <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-outline-warning me-1">
                                            <i class="bi bi-pencil-square"></i>
                                        </a>
                                        <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-outline-danger">
                                            <i class="bi bi-trash"></i>
                                        </a>
                                    }
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="5" class="text-center text-secondary py-4">
                                <i class="bi bi-box-seam display-6"></i>
                                <p class="mt-2">No services found.</p>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- Pagination -->
    @{
        var prevDisabled = !Model.HasPreviousPage ? "disabled" : "";
        var nextDisabled = !Model.HasNextPage ? "disabled" : "";
    }

    <div class="d-flex justify-content-between align-items-center mt-4 flex-wrap text-light">
        <p class="mb-0">Total Services: @Model.TotalCount</p>
        <div class="pagination-controls d-flex align-items-center gap-2">
            <a asp-action="Index"
               asp-route-sortOrder="@ViewData["CurrentSort"]"
               asp-route-pageNumber="@(Model.PageIndex - 1)"
               asp-route-currentFilter="@ViewData["CurrentFilter"]"
               class="btn btn-outline-light @prevDisabled">
                <i class="bi bi-arrow-left-circle"></i> Previous
            </a>
            <span>Page @Model.PageIndex of @Model.TotalPages</span>
            <a asp-action="Index"
               asp-route-sortOrder="@ViewData["CurrentSort"]"
               asp-route-pageNumber="@(Model.PageIndex + 1)"
               asp-route-currentFilter="@ViewData["CurrentFilter"]"
               class="btn btn-outline-light @nextDisabled">
                Next <i class="bi bi-arrow-right-circle"></i>
            </a>
        </div>
    </div>
</div>

<!-- Styles -->
<style>
    body {
        background: linear-gradient(135deg, #141E30, #243B55);
        color: white;
    }

    .glass-card {
        background: rgba(255, 255, 255, 0.08);
        border-radius: 16px;
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.15);
        color: white;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(255, 255, 255, 0.12);
        transition: all 0.2s ease;
    }

    .table-header {
        border-bottom: 2px solid rgba(255, 255, 255, 0.15);
    }

    .btn-outline-light:hover {
        background-color: white;
        color: black;
    }

    .pagination-controls {
        font-weight: 500;
    }

    .btn-outline-warning:hover {
        background-color: #ffc107;
        color: black;
    }

    .btn-outline-danger:hover {
        background-color: #dc3545;
        color: white;
    }
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
